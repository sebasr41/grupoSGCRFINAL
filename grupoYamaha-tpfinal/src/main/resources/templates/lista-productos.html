<!DOCTYPE html>
<html lang="es" xmlns:th="https://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link th:rel="stylesheet" th:href="@{https://use.fontawesome.com/releases/v5.15.3/css/all.css}"
		integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">
	<link th:rel="stylesheet" th:href="@{css/styles.css}">
	<link th:rel="stylesheet" th:href="@{webjars/bootstrap/4.6.0/css/bootstrap.min.css}">
	<link rel="shortcut icon" href="img/favicon.png" />
	<title>Productos</title>
</head>

<body class="body-gam">

	<!--   HEADER    -->
	<div th:replace="layouts/header :: header"></div>

	<!--   NAV WITH TABS    -->
	<div th:replace="layouts/nav-tabs :: div"></div>

	<div class="container">
		<div class="show-case-2">
			<h1 class="text-center text-light text-uppercase pt-5 font-weight-bold">Nuestros vehículos</h1>
		</div>
	</div>
	<!--Formulario de busqueda -->
	<div class="row">
		<div class="col-md-8 d-block m-auto">

			<form class="text-light mb-4 px-4 py-4 bg-pv--form rounded gam-overflow" th:action="@{/products-busqueda}"
				th:object="${product}" th:method="POST">
				<div class="row d-flex justify-content-center">

					<div class="form-group col-md-5">

						<label for="nombreCategoria">Nombre</label> <input type="text" class="form-control"
							id="nombreCategoria" th:field=*{productName}>
					</div>
					<div class="form-group col-md-5">
						<label for="precioProducto">Monto superior a</label> <input type="number" class="form-control"
							id="precioProducto" th:field=*{buyPrice}>
					</div>
					<div class="form-group col-md-5">
						<label for="producto">Nombre de la categoría</label>
						<select id="producto" th:field="*{productLines.productLinesName}" class="form-control">
							<option value="">Todas las categorías</option>
							<option th:each="prod : ${productslines}" th:value="${prod.productLinesName}"
								th:text="${prod.productLinesName}" th:selected="false"></option>
						</select>
					</div>
					<div class="form-group col-md-5" style="margin-top: 0.42rem;">
						<button type="submit" class="btn btn-success mt-4 ">Buscar</button>
					</div>
				</div>
			</form>
		</div>

		<!--Resultados con bucle-->
		<div class="container">
			<div class="row">
				<!--Asi se deberia ver-->
			<div class="col-3   mb-4" th:each="prod : ${products}">
				<div class="card">
					<img th:src="*{'imagPvisual/'+prod.productLines.image}" class="card-img-top" width="300" height="300"
						alt="Imagen de categoria">
					<div class="card-body card-gam-bg rounded-bottom rounded-lg text-light">
						<h1 class="card-title" th:text="${prod.productName}"></h1>
						<h5 class="mt-4 card-text"  th:text="'Categoria: '+${prod.productLines.productLinesName}"></h5>
						<h5 class="card-text" th:text="'Cantidad: '+${prod.quantityInStock}"></h5>
						<h5 class="card-text" th:text="'Precio: '+ '$' + ${prod.buyPrice}"></h5>
						<a th:href="@{/products-editar-} + ${prod.productCode}" class="btn btn-warning px-4"><i
									class="fas fa-edit text-light"></i></a>
						<a th:href="@{/products-eliminar-} + ${prod.productCode}" class="btn btn-danger px-4"><i
									class="fas fa-trash-alt text-light"></i></a>
						<button type="button" class="btn btn-success px-4" data-toggle="modal"
								data-target="#myModal" th:attrappend="data-target=${prod.productCode}"><i
									class="fas fa-shopping-cart text-light"></i>
							</button>
							
							
							<div class="modal fade" id="myModal" role="dialog" th:attrappend="id=${prod.productCode}">
								<div class="modal-dialog">

									<!-- Modal content-->
									<div class="modal-content">
										<div class="modal-header bg-pv--form">
											<h5 class="modal-title">Formulario de compra</h5>
											<button type="button" class="close text-light" data-dismiss="modal"
												aria-label="Close">
												<span aria-hidden="true">&times;</span>
											</button>
										</div>

										<div class="modal-body body-gam ">

											<!--Form code start from here  -->

											<form th:action="@{/order-form-}+ ${prod.productCode}" method="POST" th:object="${orderdetails}"
												class="text-light mt-3 mb-4 px-4 py-4 bg-pv--form rounded gam-overflow">

												<!--Oculto-->											
													<select id="producto" 
														class="form-control d-none">
														<option th:value="${prod}"
															th:text="${prod.productCode}" th:selected="false">
														</option>
													</select>													
												<!--Oculto-->
												<div class="row d-flex justify-content-center">
													<div class="form-group col-md-5">
														<label for="orden">Cantidad de ordenes</label> <input
															th:field="*{quantityOrdered}" type="number"
															class="form-control" id="date"
															th:value="${prod.productCode}">
													</div>
													<div class="form-group col-md-5">
														<label for="precio">Línea de número</label>
														<input th:field="*{orderLineNumber}" type="number"
															class="form-control" id="linea">
													</div>

												</div>
												<div class="row d-flex justify-content-center">

						
												</div>
												
												<div class="row mt-3">
													<div class="form-group col-md-12">
														<div class="col mb-4">
															<div class="card">
																<div
																	class="card-body card-gam-bg rounded-bottom rounded-lg text-light">
																	<h5 class="card-title" th:text="${prod.productName}">
																	</h5>
																	<p class="card-text"
																		th:text="${prod.productDescription}"></p>
																</div>
															</div>
														</div>
													</div>
												</div>

												<div class="row d-flex justify-content-between">
													<button type="submit" class="btn btn-primary ml-5">Ordenar</button>
													<button type="button" class="btn btn-light mr-5"
													data-dismiss="modal">Cancelar</button>
												</div>
											</form>


										</div>									

									</div>

								</div>
							</div>	
							
							
					</div>
				</div>
				
			</div>
			
		
		</div>	
		</div>
		
		

		
	</div>


	<script th:src="@{webjars/jquery/3.5.1/jquery.min.js}"></script>
	<script th:src="@{webjars/popper.js/1.16.1-lts/popper.min.js}"></script>
	<script th:src="@{webjars/bootstrap/4.6.0/js/bootstrap.min.js}"></script>

</body>

</html>